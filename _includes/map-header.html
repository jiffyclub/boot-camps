<script>
  function MarkerPin(color) {
    var pin = new google.maps.MarkerImage(
        "http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|" + color,
        new google.maps.Size(21, 34),
        new google.maps.Point(0,0),
        new google.maps.Point(10, 34));
    return pin;
  }

  function set_info_window(map, marker, info_window, content) {
    google.maps.event.addListener(marker, 'click', function () {
      info_window.setContent(content);
      info_window.open(map, marker);
    })
  }

  function initialize_map() {
    var mapOptions = {
      zoom: 1,
      center: new google.maps.LatLng(0,0),
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var oldPin = MarkerPin("FE7569");
    var newPin = MarkerPin("6975FE");

    var pinShadow = new google.maps.MarkerImage(
        "http://chart.apis.google.com/chart?chst=d_map_pin_shadow",
        new google.maps.Size(40, 37),
        new google.maps.Point(0, 0),
        new google.maps.Point(12, 35));

    var info_window = new google.maps.InfoWindow({});

    var map = new google.maps.Map(document.getElementById('map_canvas'),
        mapOptions);

{% for bootcamp in site.posts reversed %}
  {% if bootcamp.latlng %}
    var marker = new google.maps.Marker({
        position: new google.maps.LatLng({{bootcamp.latlng}}),
        map: map,
        title: "{{bootcamp.title}}",
    {% if bootcamp.date >= site.time %}
        icon: newPin,
    {% else %}
        icon: oldPin,
    {% endif %}
        shadow: pinShadow,
        });

    var info_string = '<div id="info-window">' +
        '<h4>{{bootcamp.title}}</h4>' +
        '<p>Visit the ' +
        '<a href="{{bootcamp.url | prepend: site.baseurl}}">' +
        'boot camp page</a> for more info.</p>' +
        '</div>';

    set_info_window(map, marker, info_window, info_string);
  {% endif %}
{% endfor %}

  }
</script>
